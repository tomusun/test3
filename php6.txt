PHP動画6(MySQLのAdminボタンを押すとエラー、phpMyAdmin、Auto_Increment、漢字をソート)
◯XAMPPのコントールパネルでMySQLのAdminボタンを押すとエラー画面が表示される。
「mysqli_real_connect(): The server requested authentication method unknown to the client [caching_sha2_password]」や「MySQL サーバに接続しようとしましたが拒否されました。config.inc.php のホスト、ユーザ名、パスワードが MySQL サーバの管理者から与えられた情報と一致するか確認してください。」など。
解決方法



■Javaの勉強で使うためにインストールしていたMySQLはタスクマネージャより、プロセスタブからタスクの終了。
XAMPPのConfigボタンよりMySQLのポート番号を3307から3306に変更。
config.inc.phpのパスワードは$cfg['Servers'][$i]['password'] = '';の戻して起動しなおしたら上手くいった。
※参考
https://okwave.jp/qa/q4346844.html
⇒
これからできる事として、
まず、ＸＡＭＰＰのコントロールパネルから、ＭｙＳＱＬを停止してください。
それから、コマンドプロンプトで、「netstat -an -o」を実行してみてください。
ＩＰアドレスとポート、それからＰＩＤが表示されると思います
※
C:\xampp\phpMyAdmin
config.inc.php

◯phpMyAdmin



というツールを使ってMySQLにアクセスしている状態。
マウスの操作によって操作できるようにしたツール。

◯phpMyAdminのデータベースの作成



■phpMyAdminのデータベースタグのデータベースを作成するの箇所で
「mydb」を入力。
文字コードはutf8でmb4という4バイト文字を使えるやつでgeneralを選択。
⇒
DBを作成するとその中のテーブルを作成する。
テーブル名は「items」にしてカラム数は2にしてみる。
⇒
次にカラムの設計。
カラム名はidとname。
idのデータ型はint
nameのデータ型はTEXT
にしてみる。
その後、保存ボタンを押してみる。
※型として
varcharは文字数を指定した文字列
TEXTは自由に入力できる型

◯データを入れるときは



挿入ボタンを押す。
先ほど作ったカラムが表示される。
値に1と商品1をそれぞれ入れてみて実行ボタン
⇒
「1 行挿入しました」と出る。

◯テーブル作成
例
CREATE TABLE my_items (id INT,item_name TEXT,price INT);



返り値が空でした (行数 0)。 (Query took 0.0156 seconds.)
と出るが正常な動作

◯プライマリーキーの設定



■テーブルの中を空っぽにして行う必要があるので
すでにデータが入っている場合は操作タブをクリックして
「テーブルを空にする」のリンクをクリックするとよい。
構造タブのカラムに対して主と書いている鍵マークをクリックするとプライマリーキーの設定ができる。
※新規テーブル作ってカラム設定するときにインデックスをPRIMARYとも選べる


◯IDなどレコード挿入するときに
自動で入れてくれるのが



Auto_Increment
■構造タブでIDに対して変更のリンクをクリック
A_Iと書かれている部分がAuto_Incrementのこと。
A_Iのチェックボックスを入れて保存ボタンを押すとAuto_Incrementが設定される。
⇒
挿入タブでデータを挿入するときにIDは入力しなくてよい。
⇒
INSERT INTO `my_items` (`id`, `item_name`, `price`) VALUES (NULL, 'いちご', '50');
でデータ挿入できる。前のレコードに合わせて、idには自動で値が入る。

・idが
1
2
3
4
5
とある状態で3のレコードを削除後、
データを挿入すると



idが6のレコードが入る
idが3は永久欠番扱い。
※idが3でレコードが入ってしまうと、リレーションという関係が崩れてしまって本当のデータが何だったのか
というのが分からなくなってしまうため、データベースでは一度削除したIDは再び使わないというのが一般的。

・漢字をソートする場合



栗など
文字コードと呼ばれるコード表で漢字が並ぶようになる。読み方が何であるかはコンピューター
は判別できない。
TEXTの情報で並び変える必要がある場合、1つカラムを追加しなければならない。
例
item_name_kana　TEXT型
を作る。
item_name item_name_kana
いちご イチゴ
りんご リンゴ
バナナ バナナ
栗 クリ
⇒
select * FROM my_items order by item_name_kana
実行後
イチゴ
クリ
バナナ
リンゴ
※このように日本語の文字列を扱うカラムの場合、フリガナを振っておくと後で
並び替えが便利になる。